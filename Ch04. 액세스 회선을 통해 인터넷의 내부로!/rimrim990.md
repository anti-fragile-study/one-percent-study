## Chapter 04. 액세스 회선을 통해 인터넷의 내부로!

### 03. 액세스 회선으로 이용하는 PPP와 터널링

>인터넷은 원래 다수의 라우터를 함께 연결하여 만든 것이므로 액세스 회선을 라우터에 연결하는 것이 원칙입니다.

- `ADSL`이나`FTTH`액세스 회선을 라우터인`BAS`에 연결한다
- `BAS`는`PPPoE`를 사용하여 로그인 동작을 수행한다
- `PPPoE`는 기존의`PPP`패킷을 이더넷 형식으로 감싸 전송

**PPPoE**
- 인터넷 프로바이더는 인증된 사용자에게만 IP 주소를 동적으로 할당한다
- 인터넷 프로바이더는 사용자 인증을 위해`PPPoE`프로토콜을 사용한다
- 인터넷 접속용 라우터는 인증이 끝나면 퍼블릿 IP 주소, DNS 서버의 IP 주소, 기본 게이트웨이의 IP주소를 받는다
- 인터넷 접속용 라우터는 사설 IP를 할당받은 퍼블릭 IP 주소로 변환해준다

**정리**
- IP 주소를 할당할 때`DHCP`프로토콜만 사용하는줄 알았는데,`PPPoE`도 사용함을 알게 되었다.
`PPPoE`는 인증된 사용자만 동적 IP를 할당하는 반면에,`DHCP`는 인증 절차를 요구하지 않는다.
- `PPPoE`는 캠퍼스에서 주로 사용된다고 하는데, 생각해보니 학교 인터넷에 접속하려면 아이디와 패스워드를 입력했어야 했다.
이게`PPPoE`인증을 위해 필요했던 걸까?
  - 찾아보니 캠퍼스 아이디와 패스워드를 입력하는 것은 `TTLS`라는 보안 연결을 위해 사용된다고 한다.
  - `PPPoE`는 데이터 링크 계층 프로토콜인 반면에, `TTLS`는 일종의 `TLS` 프로토콜이며 전송 계층에서 사용된다고 한다.

### 04. 프로바이더의 내부
>인터넷의 실체는 한 개의 조직이 운영 관리하는 단일 네트워크가 아니라 다수의 프로바이더의 네트워크를 서로 접속한 것이다.

- `ADSL`이나`FTTH`액세스 회선은 사용자가 계약한 프로바이더의`POP`라우터에 연결된다
- `POP`는 연결된 회선의 종류에 따라 라우터를 연결하고 있다
- `POP`에는 프로바이더의 중심이 되는`NOC`나 다른`POP`에 연결하기 위한 라우터도 존재한다
- `POP`에서 들어온 모든 패킷은`NOC`로 모여드는데, 여기서 목적지 근처의`POP`나 다른 프로바이더로 패킷을 전송한다

### 05. 프로아이더를 경유하여 흐르는 패킷
>결국 인터넷의 라우터에는 최종 목적지가 동일 프로바이던지, 다른 프로바이던지와 상관 없이 모든 경로가 등록되어 있습니다.

- 디테일에 차이는 있겠지만, 결국 인터넷의 본질은 연결된 라우터끼리 패킷을 중개하는 것이다
- 클라이언트의 프로바이더에서 웹 서버가 속한 프로바이더의`POP`로 패킷이 전달돈다

**BGP**
- 프로바이더 라우터끼리 경로 정보 교환을 위해 사용하는 프로토콜이다
- 프로바이더 라우터끼리 연결된 네트워크 정보를 교환한다
- 사내 네트워크에서는 최단 경로로 패킷을 전송하기 위해 라우터 간에 무차별적으로 경로 정보를 교환한다.
그러나 프로바이더는 지정된 프로바이더의 라우터하고만 경로 정보를 교환한다

**IX**
> * ISP(Internet Service Provider): 인터넷 서비스를 제공하는 회사
> * NSP(Network Service Provider): ISP들에게 고속의 인터넷 접속 회선을 제공하는 업체로 한국에서는 ISP가 NSP 역할도 겸하고 있음.
> * IX(Internet eXchange): ISP와 NSP의 인터넷 트래픽을 상호 교환해주는 최상부 네트워크, 한국에는 KINX를 포함하여 4개의 업체가 있음. (KINX)
- ISP들은 하나의 IX에 연결하여ㅕ 모든 ISP를 연결한 효과를 낼 수 있다 

**정리**
- 프로바이더 간에도 무조건 최단 경로를 우선시 할 줄 알았는데, 여러가지 이해관계가 연관되어 그러지는 않는 것 같다
- `LAN`과 인터넷 코어를 구분해서 생각하지 않았는데, 이를 구성하는 장비에 많은 차이가 있음을 알게 되었다
