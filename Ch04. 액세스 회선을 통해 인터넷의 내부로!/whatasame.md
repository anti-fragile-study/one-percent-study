## Chapter 04 액세스 회선을 통해 인터넷의 내부로!

### ADSL 기술을 이용한 액세스 회선의 구조와 동작

LAN에서 사용하는 라우터와 인터넷에서 사용하는 라우터의 동작은 기본적으로 같다. 그러나 인터넷의 경우 네트워크 장치 사이의 거리가 훨씬 길고 중계할 대상도 매우 많으므로 이를 고려해야한다. 라우터에서 중계 대상을 찾는 방법은 동일하지만 패킷을 송신하는 방법이 다르다. 인터넷 접속용 라우터는 액세스 회선의 규칙에 따라 패킷 송신 동작을 실행한다.

액세스 회선은 인터넷과 LAN을 연결하는 통신 회선을 말한다. 그 중 하나는 ADSL로서 일반 전화선을 이용하여 고속 통신을 하는 기술이다. ADSL에서 인터넷 접속용 라우터는 BAS라는 장치에서 사용할 목적으로 MAC 헤더, PPPoE 헤더, PPP 헤더를 붙여 ADSL 모뎀에 패킷을 전송한다.

> 인터넷 접속용 라우터라는 것이 게이트웨이 라우터와 동일한 것일까?

ADSL 모뎀은 받은 패킷을 ATM 셀로 나눈다. ATM 셀은 5바이트 헤더와 48바이트의 데이터의 형태를 띄고 있으며 전화 회선을 사용한 통신 방식인 ATM에서 사용한다.

> 네트워크에는 ATM 셀과 같이 데이터를 쪼개서 전송하는 경우가 잦은 것 같다. Network layer에서 segment를 이야기할 때도 MTU, MSS와 같은 용어가 등장했듯이 말이다.

ADSL 모뎀은 나뉜 ATM 셀을 전기 신호로 변조하여 전기 신호로 변환한다. 이때 변조 방법에는 ASK, PSK, QAM이 있다.

- ASK(진폭 변조 방식)
  - 진폭(amplitude)의 크기를 단계로 나누어 비트를 표현한다.
  - 진폭의 크고 작음의 단계를 늘릴 수록 대응하는 비트 수를 늘릴 수 있다.
  - 신호는 전달 도중 잡음에 의해 파형이 변형되는데, 단계를 너무 많이 늘리면 수신 측에서 인접 단계와 오인할 가능성이 커져 오류의 원인이 된다.
- PSK(위상 변조 방식)
  - 신호의 위상(phase)의 각도를 단계로 나누어 비트를 표현한다.
  - 각도의 단계를 세분화하여 대응하는 비트를 늘릴 수 있다.
  - 각도를 너무 나눠 각도가 가까워지면 판별할 수 없게 되어 오류가 발생하기 쉽다.
- QAM(직교 진폭 변조 방식)
  - ASK와 PSK를 결합하여 진폭과 위상에 각각 비트를 대응시켜 표현한다.
  - 이 또한 ASK와 PSK 같이 단계 수가 너무 증가할 경우 판별하기 어렵다.

주파수가 서로 다른 파를 혼합하여 파를 합성하면 표현할 수 있는 비트가 늘어난다. 수신 측에서는 파형 필터를 사용하여 주파수마다 파를 분리할 수 있다.

ADSL(asymmetric digital subscriber line)은 이름에서 알 수 있듯 비대칭을 나타내는데 이는 다운로드와 업로드의 통신 속도의 비대칭을 나타낸다. 잡음이 없는 주파수의 파에는 다수의 비트를 대응시키고, 잡음이 있는 주파수의 파에는 소수의 비트를 대응시킨다. 다운로드에 사용하는 높은 주파수의 파는 감쇠가 크고 잡음의 영향을 받기 쉬우므로 소수의 비트를 대응시킨다. 따라서 다운로드의 속도를 높이기 위해 많은 수의 파를 사용하는데, 업로드에 사용하는 파의 개수보다 다운로드에 사용하는 파의 개수가 더 많기 때문에 둘의 속도가 다르다.

> 예전에 SKT 인터넷을 썼었는데 게임을 할 때마다 ping이 들쑥날쑥 했다. 어렸던 나는 지식in에 이에 대해 물어봤었고 비대칭 인터넷이 원인이라는 것을 알았다. 그때 당시 우리 집에는 SKT에서 대칭형 인터넷을 사용할 수 없었기 때문에 KT로 변경하였는데 인터넷을 바꾸자마자 거짓말같이 ping 문제는 사라졌다.

ADSL는 일반 전화에 사용하는 전화 선을 사용하므로 전화 신호와 ADSL 신호가 섞일 수밖에 없다. 이를 구분하는 것이 스플리터이다. 스플리터는 수신을 할 때만 둘을 구분하는데, 일정한 주파수를 초과하는 신호를 차단하여 ADSL의 높은 주파수 신호를 차단하는 식으로 구분한다. 그 결과로 전화기에는 전화의 신호만 흐르고 ADSL 모뎀으로 향하는 신호는 섞인 상태로 흘려보낸다. ADSL 모뎀에는 ADSL에 사용하는 주파수에서 벗어난 불필요한 주파수를 차단하는 기능이 있기 때문에 스플리터가 구분할 필요가 없다.

전화국에는 다수의 ADSL 모뎀에 해당하는 기능을 묶어 하나의 케이블에 넣은 DSLAM이라는 장치를 사용하는데 이더넷 인터페이스가 아닌 ATM 인터페이스를 갖는다. 따라서 DSLAM은 ATM 셀의 형태 그대로 후방의 라우터와 데이터를 주고 받는데 패킷 중계 장치 BAS가 ATM 인터페이스를 갖고 있기 때문에 불필요하게 데이터를 변환할 필요가 없기 때문이다.

BAS는 ATM 셀을 패킷으로 복원하여 인터넷의 내부에 중계하는데 앞서 인터넷 접속용 라우터가 MAC 헤더, PPoE 헤더, PPP 헤더를 붙인 이유는 BAS의 인터페이스에 패킷을 건네주기 위해 사용하는 것이다. 이는 이더넷에서 라우터가 패킷을 수신했을 때 MAC 헤더를 제거하는 것과 같다.

### 광섬유를 이용한 액세스 회선

> 물리적인 지식이 다소 있어 당황했지만 그래도 아는 지식을 총동원하여 읽었다. ADSL와 FTTH의 동작 방식의 차이는 알겠는데 그 차이로 인한 장단점을 알 수 없어서 아쉬웠다.

ADSL에서 여러 파형을 합성하여 사용하는 것과 달리 광신호는 밝으면 1을, 어두우면 0을 나타낸다. 디지털 데이터를 광신호로 바로 바꿀 순 없어서 디지털 데이터 → 전기 신호 → 광신호 순으로 바꾼다.

광원에서 나온 빛은 코어를 통과하는데 입사각이 큰 것은 밖으로 누설되고 입사각이 작은 빛이 전반사되어 코어 속을 진행한다. 반사된 빛은 각도에 따라 위상차가 발생하는데 이때 위상이 반대인 파는 서로 상쇄되어 소멸되고 위상이 같은 파는 서로 겹쳐져서 강해진다.

광섬유 코어의 굵기에 따라 싱글모드, 멀티 모드로 구분할 수 있다.

- 싱글 모드
  - 코어의 직경이 작음
  - 입사각이 가장 작은 빛만 진행 가능
  - 코어를 진행하는 빛이 단 하나이기 때문에 빛의 양이 적어 광원이나 수광 소자의 성능이 좋아야함
  - 코어를 진행하는 빛이 단 하나이기 때문에 거리가 달라서 도착 시간에 차이가 생기는 현상이 없기 때문에 케이블 길이에 따른 신호 변형이 없음
  - 장거리 통신에 적합
- 멀티 모드
  - 코어의 직경이 큼
  - 입사각이 작은 순으로 여러 빛이 진행 가능
  - 코어에서 진행하는 빛이 여러 개이므로 빛의 양이 많아 광원이나 수광 소자의 성능이 낮아도 괜찮음
  - 큰 각도로 들어온 빛은 반사 횟수가 많아 진행하는 거리가 길고 작은 각도로 들어온 빛은 반사 횟수가 적어 진행하는 거리가 짧은데, 이러한 차이로 인해 신호가 도착하는 시간이 일정하지 않아 신호의 폭이 넓어지고 이는 신호가 변형되었다는 것을 의미
  - 단거리 통신에 적합

하나의 광섬유로 송신과 수신을 하면 두 개의 광신호가 혼합된다. 이를 해결하기 위해 상향 광신호화 하향 광신호의 파장을 변화하여 전송하고 수신 측에서 프리즘의 원리로 이를 분리하여 데이터를 처리한다. ASDL에선 송신과 수신 모두에서 파장의 합성을 사용하지만 FTTH의 경우 개별적인 송신과 수신에서는 합성하지 않고 광섬유 단위에서 합성한다.

하나의 광섬유를 하나의 사용자가 사용할 수도 있지만 광스플리터를 이용하면 하나의 광섬유로 복수의 사용자를 연결할 수 있다. 이때 충돌이 발생할 수 있는데 사용자 측에 ONU, BAS 측에 OLT이라는 장치를 설치하여 패킷의 충돌을 방지할 수 있다. 이는 OLT이 사용자 측의 ONU에게 송신 지시를 내리고 ONU가 송신 동작을 실행하는 형태로 동작한다.
